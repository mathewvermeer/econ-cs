library(ggplot2)
library(plyr)

wrap.it <- function(x, len)
{ 
  sapply(x, function(y) paste(strwrap(y, len), 
                              collapse = "\n"), 
         USE.NAMES = FALSE)
}


# Call this function with a list or vector
wrap.labels <- function(x, len)
{
  if (is.list(x))
  {
    lapply(x, wrap.it, len)
  } else {
    wrap.it(x, len)
  }
}

ransomware <- read.csv("https://ransomwaretracker.abuse.ch/feeds/csv/",header = TRUE,sep = ",",skip = 8)
ransomware <- ransomware[!(is.na(ransomware$Malware) | ransomware$Malware==""), ]
ransomware <- ransomware[!(is.na(ransomware$Registrar) | ransomware$Registrar==""), ]
counts <- count(ransomware, vars=c("Registrar", "Malware"))
ordered <- counts[order(-counts$freq), ]
top10 <- ordered[1:10, ]

par(mar=c(15, 3, 3, 1))
midpoints <- barplot(top10$freq, names=wrap.labels(top10$Registrar, 15), xlab = "Registrar", ylab = "Amount", main = "Malware per registrar", las=2)
text(midpoints, 150, labels=top10$Malware, srt=45)
